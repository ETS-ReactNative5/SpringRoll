/*! SpringRoll 0.3.27 */
!function(){"use strict";!function(){var a=function(a,b,c){this.anim=a,this.loop=!!b,this.speed=c>0?c:1};namespace("springroll.pixi").ParallelSpineData=a}(),function(){var a=include("PIXI.Spine"),b=include("PIXI.spine.AnimationState"),c=include("PIXI.Texture"),d=include("springroll.pixi.ParallelSpineData"),e=function(a,b,c,d){this.eventList=[],this.init(a,b,c,d)};e.constructor=e;var f=e.prototype;f.init=function(b,c,d,e){return this.clip=b,this.isSpine=b instanceof a,this.callback=c,this.cancelledCallback=e,this.duration=0,this.speed=d,this.eventList.length=0,this.listIndex=-1,this.spineStates=null,this.isLooping=null,this._time_sec=0,this.soundAlias=null,this.soundInst=null,this.playSound=!1,this.soundStart=0,this.soundEnd=0,this.useCaptions=!1,this._paused=!1,this.isAnim=!1,this.complete=!1,this},f._nextItem=function(){var a=!1;if(this.isLooping)this.soundInst&&this.soundInst.stop(),a=!0;else if(this.soundEnd=this.soundStart=0,this.isAnim=this.playSound=this.useCaptions=!1,this.soundInst=this.soundAlias=null,this.spineStates=this.spineSpeeds=null,this.isLooping=!1,++this.listIndex>=this.eventList.length)return void(this.complete=!0);var e,f,g=this.eventList[this.listIndex];switch(typeof g){case"object":this.isAnim=!0;var h=g.anim,i=this.clip;if(this.isLooping=!!g.loop,this.speed=g.speed>0?g.speed:1,"string"==typeof h)this.duration=i.stateData.skeletonData.findAnimation(h).duration,i.state.setAnimationByName(h,this.isLooping);else if(h[0]instanceof c)i.textures=h,i.updateDuration(),this.duration=i._duration,i.gotoAndPlay(0);else if(h[0]instanceof d){this.spineStates=new Array(h.length),this.spineSpeeds=new Array(h.length),this.duration=0;var j,k=0,l=0;for(f=i.stateData.skeletonData,e=0;e<h.length;++e){var m=new b(i.stateData);this.spineStates[e]=m;var n=h[e].loop;m.setAnimationByName(h[e].anim,n),j=f.findAnimation(h[e].anim).duration,n?j>l&&(l=j):j>k&&(k=j),h[e].speed>0?t.spineSpeeds[e]=h[e].speed:t.spineSpeeds[e]=1}this.duration=k||l}else{var o=i.state;if(f=i.stateData.skeletonData,this.duration=f.findAnimation(h[0]).duration,1==h.length)o.setAnimationByName(h[0],this.isLooping);else for(o.setAnimationByName(h[0],!1),e=1;e<h.length;++e)o.addAnimationByName(h[e],this.isLooping&&e==h.length-1),this.duration+=f.findAnimation(h[e]).duration}var p="number"==typeof g.start?.001*g.start:0;this._time_sec=a?0:p<0?Math.random()*this.duration:p,g.alias&&(this.soundAlias=g.alias,this.soundStart=g.audioStart,this.playSound=!0,this.useCaptions=g.useCaptions);break;case"number":this.duration=g,this._time_sec=0;break;case"function":g(),this._nextItem()}},Object.defineProperty(f,"time",{get:function(){return 1e3*this._time_sec},set:function(a){this._time_sec=.001*a}}),Object.defineProperty(f,"paused",{get:function(){return this._paused},set:function(a){a!=this._paused&&(this._paused=!!a,this.soundInst&&(this.paused?this.soundInst.pause():this.soundInst.unpause()))}}),namespace("springroll.pixi").AnimatorTimeline=e}(),function(a){var b,c=include("PIXI.Spine"),d=include("PIXI.Texture"),e=include("springroll.pixi.AnimatorTimeline"),f=include("springroll.pixi.ParallelSpineData"),g=include("springroll.Application"),h=include("PIXI.MovieClip"),i={},j=null,k=0,l=null;i.captions=null,i.init=function(){l=[],j=[],b=include("springroll.Sound",!1)},i.play=function(a,b,c,e){var h,l;if(c&&"function"!=typeof c?(l=c,c=l.onComplete,e=l.onCancelled):!0===e&&(e=c),!i.canAnimate(a))return void(c&&c());if(i.stop(a),l&&(h=l.audio||l.soundData||null),"string"==typeof b)b=[{anim:b,audio:h}];else if(Array.isArray(b)){var m=b[0];m instanceof d?b=[{anim:b,audio:h}]:"string"==typeof m?b=[{anim:b,audio:h}]:m instanceof f&&(b=[{anim:b,audio:h}])}else b=[b];var q=i._makeTimeline(a,b,c,e);return q.eventList.length<1?(n(q),c&&c(),null):(q._nextItem(),p(q,q._time_sec,0),j.push(q),1==++k&&g.instance.on("update",o),q)},i._makeTimeline=function(a,c,f,g){var h,j,k,n,o=l.length?l.pop().init(a,f,g):new e(a,f,g);for(h=0;h<c.length;++h){var p=c[h];if("number"!=typeof p)if("function"!=typeof p){if(k=p.anim,n=p.audio,o.isSpine)if("string"==typeof k)m(a,k)&&o.eventList.push(p);else if("string"==typeof k[0]){for(j=k.length;j>=0;--j)m(a,k[j])||k.splice(j,1);k.length&&o.eventList.push(p)}else{for(j=k.length;j>=0;--j)m(a,k[j].anim)||k.splice(j,1);k.length&&o.eventList.push(p)}else{if(!(k[0]instanceof d))continue;o.eventList.push(p)}if(n&&b){var q,r;"string"==typeof n?(r=0,q=n):(r=n.start>0?.001*n.start:0,q=n.alias),!b.instance.systemMuted&&b.instance.exists(q)&&(b.instance.preloadSound(q),p.alias=q,p.audioStart=r,p.useCaptions=i.captions&&i.captions.hasCaption(q))}}else o.eventList.push(p);else o.eventList.push(.001*p)}return o},i.canAnimate=function(a){return!!a&&(a instanceof c||a instanceof h||!(!a.hasOwnProperty("textures")||!a.hasOwnProperty("_elapsedTime")))},i.getDuration=function(a,b){var c=0;if("string"==typeof b)b=[{anim:b}];else if(Array.isArray(b)){var e=b[0];e instanceof d?b=[{anim:b}]:"string"==typeof e?b=[{anim:b}]:e instanceof f&&(b=[{anim:b}])}else b=[b];for(var g=0;g<b.length;++g){var h=b[g];switch(typeof h){case"object":var i=h.anim;if("string"==typeof i)c+=a.stateData.skeletonData.findAnimation(i).duration;else if(i[0]instanceof d)c+=i.length/a.fps;else if(i[0]instanceof f){this.spineStates=new Array(i.length),this.spineSpeeds=new Array(i.length);var j,k=0,l=0;for(skeletonData=a.stateData.skeletonData,g=0;g<i.length;++g){var m=i[g].loop;j=skeletonData.findAnimation(i[g].anim).duration,m?c>l&&(l=j):c>k&&(k=j)}c+=k||l}else for(skeletonData=a.stateData.skeletonData,g=0;g<i.length;++g)c+=skeletonData.findAnimation(i[g]).duration;break;case"number":c+=.001*h}}return 1e3*c},i.instanceHasAnimation=function(a,b){return a instanceof c&&m(a,b)};var m=function(a,b){return null!==a.stateData.skeletonData.findAnimation(b)};i.stop=function(a,b){for(var c=0;c<k;++c)if(j[c].clip===a){var d=j[c];j.splice(c,1),0==--k&&g.instance.off("update",o),d.cancelledCallback&&d.cancelledCallback(),d.soundInst&&d.soundInst.stop(),n(d);break}},i.stopAll=function(b){b=b!==a||!!b;for(var c=0;c<k;++c){var d=j[c];b&&d.cancelledCallback&&d.cancelledCallback(),d.soundInst&&d.soundInst.stop(),n(d);break}g.instance.off("update",o),j.length=k=0};var n=function(a){a.clip=null,a.callback=null,a.cancelledCallback=null,a.isLooping=!1,a.spineStates=null,a.speed=null,a.soundInst=null,l.push(a)},o=function(a){for(var c=.001*a,d=k-1;d>=0;--d){var e=j[d];if(!e.paused){var f=e._time_sec,h=!1,l=0;if(e.isAnim){if(e.soundInst)if(e.soundInst.isValid){var m=.001*e.soundInst.position;if(m<0&&(m=0),e._time_sec=e.soundStart+m,e.useCaptions&&i.captions.seek(e.soundInst.position),e._time_sec>=e.duration){if(p(e,e.duration,f),l=e._time_sec-e.duration,e._nextItem(),e.complete){s(e);continue}h=!0}}else{if(e._nextItem(),e.complete){s(e);continue}h=!0}else e._time_sec+=c*e.speed,e.playSound&&e._time_sec>=e.soundStart&&(e._time_sec=e.soundStart,e.playSound=!1,e.soundInst=b.instance.play(e.soundAlias,r.bind(this,e,e.listIndex,e.soundAlias),q.bind(this,e,e.listIndex)),e.useCaptions&&i.captions.play(e.soundAlias));var n=e.clip;if(e.isSpine){if(e.spineStates){var t=p(e,e._time_sec,f);if(t){if(l=e._time_sec-e.duration,e._nextItem(),e.complete){s(e);continue}h=!0}else e._time_sec>e.duration&&(l=e._time_sec-e.duration,e._nextItem(),h=!0)}else if(p(e,e._time_sec,f),e._time_sec>=e.duration){if(l=e._time_sec-e.duration,e._nextItem(),e.complete){s(e);continue}h=!0}}else if(e._time_sec>=e.duration)if(e.isLooping&&e.listIndex==e.eventList.length-1)l=e._time_sec-e.duration,e._nextItem(),e.onComplete&&e.onComplete(),h=!0;else{if(l=e._time_sec-e.duration,n.gotoAndStop(n.textures.length-1),e._nextItem(),e.complete){s(e);continue}h=!0}else n._elapsedTime=e._time_sec}else if(e._time_sec+=c*e.speed,e._time_sec>=e.duration){if(l=e._time_sec-e.duration,e._nextItem(),e.complete){s(e);continue}h=!0}if(h){for(f=0,e._time_sec+=l;e._time_sec>=e.duration;)l=e._time_sec-e.duration,e._nextItem(),e.complete?(e.clip.gotoAndStop?e.clip.gotoAndStop(e.clip.textures.length-1):p(e,e._time_sec,f),s(e)):e._time_sec+=l;e.playSound&&e._time_sec>=e.soundStart&&(e._time_sec=e.soundStart,e.playSound=!1,e.soundInst=b.instance.play(e.soundAlias,r.bind(this,e,e.listIndex,e.soundAlias),q.bind(this,e,e.listIndex)),e.useCaptions&&i.captions.play(e.soundAlias)),e.isAnim&&p(e,e._time_sec,f)}}}0===k&&g.instance.off("update",o)},p=function(a,b,c){var d=!1,e=a.clip;if(a.isSpine)if(a.spineStates)for(var f=0,g=a.spineStates.length;f<g;++f){var h=a.spineStates[f];h.update((b-c)*a.spineSpeeds[f]),h.apply(e.skeleton),!h.currentLoop&&h.isComplete()&&(d=!0)}else e.updateAnim(b-c);else e._elapsedTime=b;return d},q=function(a,b){a.listIndex==b&&(a.soundEnd=a.soundStart+.001*a.soundInst.length)},r=function(a,b,c){i.captions&&i.captions.currentAlias==c&&i.captions.stop(),a.listIndex==b&&(a.soundEnd>0&&a._time_sec<a.soundEnd&&(a._time_sec=a.soundEnd),a.soundInst=null)},s=function(a){var b=j.indexOf(a);b>=0&&(a.useCaptions&&i.captions.stop(),a.clip.onComplete=null,j.splice(b,1),0==--k&&g.instance.off("update",o),a.callback&&a.callback(),n(a))};i.destroy=function(){i.stopAll(!1),i.captions=null,l=null,j=null,g.instance.off("update",o)},namespace("springroll").Animator=i,namespace("springroll.pixi").Animator=i}(),function(){var a=include("springroll.ApplicationPlugin"),b=include("springroll.pixi.Animator"),c=new a;c.setup=function(){b.init(),b.captions=this.captions||null},c.teardown=function(){b&&b.destroy()}}();}();