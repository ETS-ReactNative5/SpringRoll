/*! SpringRoll 0.3.27 */
!function(){"use strict";!function(){var a=function(a){this.id=a,this.volume=1,this.muted=!1,this.sounds=[]};namespace("springroll").SoundContext=a}(),function(){var a,b=function(){a||(a=include("springroll.Sound")),this._channel=null,this._endFunc=null,this._endCallback=null,this._startFunc=null,this._startParams=null,this.alias=null,this._fTime=0,this._fDur=0,this._fStart=0,this._fEnd=0,this.curVol=0,this._pan=0,this.length=0,this.paused=!1,this.isValid=!0},c=b.prototype={};Object.defineProperty(c,"position",{get:function(){return this._channel?this._channel.getPosition():0}}),c.stop=function(){var b=a.instance;if(b){var c=b._sounds[this.alias];if(!c)return;var d=c.playing.indexOf(this);d>-1&&c.playing.splice(d,1),d=c.waitingToPlay.indexOf(this),d>-1&&c.waitingToPlay.splice(d,1),b._stopInst(this)}},c.updateVolume=function(b){if(this._channel){if(void 0===b){var c=a.instance,d=c._sounds[this.alias];if(d.context){var e=c._contexts[d.context];b=e.muted?0:e.volume}else b=1}this._channel.setVolume(b*this.curVol)}},Object.defineProperty(c,"volume",{get:function(){return this.curVol},set:function(a){this.curVol=a,this.updateVolume()}}),Object.defineProperty(c,"pan",{get:function(){return this._pan},set:function(a){this._pan=a,this._channel&&(this._channel.pan=a)}}),c.pause=function(){this.paused||(this.paused=!0,this._channel&&(this._channel.pause(),a.instance._onInstancePaused()))},c.unpause=function(){this.paused&&(this.paused=!1,this._channel&&(a.instance._onInstanceResume(),this._channel.resume(),this.updateVolume()))},namespace("springroll").SoundInstance=b}(),function(){var a=include("springroll.Task",!1);if(a){var b=function(b,c,d){a.call(this,b,d),this.list=c},c=a.prototype,d=extend(b,a);d.start=function(a){springroll.Sound.instance.preload(this.list,a)},d.destroy=function(){c.destroy.call(this),this.list=null},namespace("springroll").SoundListTask=b}}(),function(){function a(){var a=n.activePlugin,b=a._audioSources,c=a._soundInstances,d=a._loaders;l.context.close(),l.context=new AudioContext,l.call(a),a._loaders=d,a._audioSources=b,a._soundInstances=c;for(var e in c)for(var f=c[e],g=0;g<f.length;++g){var h=f[g];h.panNode.disconnect(0),h.gainNode.disconnect(0),h.gainNode=l.context.createGain(),h.panNode=l.context.createPanner(),h.panNode.panningModel=l._panningModel,h.panNode.connect(h.gainNode),h._updatePan(),(h._position<0||void 0===h._position)&&(h._position=0)}}function b(a){l.playEmptySound(),"running"!=l.context.state&&void 0!==l.context.state||(r.preventDefaultOnUnmute&&a.preventDefault(),document.removeEventListener("touchstart",b),document.removeEventListener("touchend",b),document.removeEventListener("mousedown",b),r.systemMuted=!1,r.trigger("systemUnmuted"))}var c,d,e,f,g,h,i,j=include("springroll.Application"),k=include("springroll.EventDispatcher"),l=include("createjs.WebAudioPlugin"),m=include("createjs.FlashAudioPlugin",!1),n=include("createjs.Sound"),o=include("springroll.Enum"),p=function(){d||(c=include("springroll.Debug",!1),d=include("springroll.Loader"),e=include("springroll.LoadTask",!1),f=include("springroll.TaskManager",!1),g=include("springroll.SoundContext"),h=include("springroll.SoundInstance"),i=include("springroll.SoundListTask",!1)),k.call(this),this._sounds={},this._fades=[],this._pool=[],this.supportedSound=null,this._contexts={},this._update=this._update.bind(this),this._markLoaded=this._markLoaded.bind(this),this._playAfterLoad=this._playAfterLoad.bind(this),this.soundEnabled=!0,this.systemMuted=createjs.BrowserDetect.isIOS,this.preventDefaultOnUnmute=!0},q=(k.prototype,extend(p,k)),r=null,s=new o("unloaded","loading","loaded");p.init=function(a,c){var d=j.instance.options;u(a)&&(a={ready:a});var e={plugins:d.forceFlashAudio?[m]:[l,m],types:["mp3"],swfPath:"assets/swfs/",ready:null};if(a=Object.merge({},e,a),a.ready=a.ready||c,!a.ready)throw"springroll.Sound.init requires a ready callback";if(m){var f=d.basePath;m.swfPath=(f||"")+a.swfPath}if(n.registerPlugins(a.plugins),createjs.BrowserDetect.isIOS&&n.activePlugin instanceof l&&"running"!=n.activePlugin.context.state?(document.addEventListener("touchstart",b),document.addEventListener("touchend",b),document.addEventListener("mousedown",b)):this.systemMuted=!1,r=new p,n.getCapabilities())r._initComplete(a.types,a.ready);else if(n.activePlugin){var g;g=function(){n.getCapabilities()&&(j.instance.off("update",g),r._initComplete(a.types,a.ready))},j.instance.on("update",g)}else this.soundEnabled=!1,a.ready&&a.ready();return r},q._initComplete=function(a,b){if(m&&n.activePlugin instanceof m)r.supportedSound=".mp3";else for(var c,d=0,e=a.length;d<e;++d)if(c=a[d],n.getCapability(c)){r.supportedSound="."+c;break}this._fixAndroidAudio=createjs.BrowserDetect.isAndroid&&n.activePlugin instanceof l,this._fixAndroidAudio&&(this._numPlayingAudio=0,this._lastAudioTime=Date.now()),b&&b()},Object.defineProperty(p,"instance",{get:function(){return r}}),q.addContext=function(a){if(a){for(var b,c=a.soundManifest||a.sounds||[],d=a.path||"",e=a.context,f={},h=0,i=c.length;h<i;++h)b=c[h],t(b)&&(b={id:b}),f=this._sounds[b.id]={id:b.id,src:d+(b.src?b.src:b.id)+this.supportedSound,volume:b.volume?b.volume:1,loop:!!b.loop,loadState:s.unloaded,playing:[],waitingToPlay:[],context:b.context||e,playAfterLoad:!1,preloadCallback:null,data:b,duration:0},f.context&&(this._contexts[f.context]||(this._contexts[f.context]=new g(f.context)),this._contexts[f.context].sounds.push(f)),!0===b.preload&&this.preloadSound(f.id);return this}},q.loadConfig=q.addContext,q.exists=function(a){return!!this._sounds[a]},q.contextExists=function(a){return!!this._contexts[a]},q.isUnloaded=function(a){return!!this._sounds[a]&&this._sounds[a].loadState==s.unloaded},q.isLoaded=function(a){return!!this._sounds[a]&&this._sounds[a].loadState==s.loaded},q.isLoading=function(a){return!!this._sounds[a]&&this._sounds[a].loadState==s.loading},q.isPlaying=function(a){var b=this._sounds[a];return!!b&&b.playing.length+b.waitingToPlay.length>0},q.getDuration=function(a){var b=this._sounds[a];if(!b)return null;if(!b.duration&&b.loadState==s.loaded){var c=n.play(a,null,null,null,null,0);b.duration=c.getDuration(),c.stop()}return b.duration},q.fadeIn=function(a,b,c,d){var e,f;if(t(a)){if(!(e=this._sounds[a]))return;e.playing.length&&(f=e.playing[e.playing.length-1])}else f=a,e=this._sounds[f.alias];if(f&&f._channel){f._fTime=0,f._fDur=b>0?b:500,f._fEnd=c||f.curVol;var g=d>0?d:0;f.volume=f._fStart=g,-1==this._fades.indexOf(f)&&(this._fades.push(f),1==this._fades.length&&j.instance.on("update",this._update))}},q.fadeOut=function(a,b,c,d){var e,f;if(t(a)){if(!(e=this._sounds[a]))return;e.playing.length&&(f=e.playing[e.playing.length-1])}else f=a;f&&f._channel&&(f._fTime=0,f._fDur=b>0?b:500,d>0?(f.volume=d,f._fStart=d):f._fStart=f.volume,f._fEnd=c||0,-1==this._fades.indexOf(f)&&(this._fades.push(f),1==this._fades.length&&j.instance.on("update",this._update)))},q._update=function(a){for(var b,c,d,e,f,g,h=this._fades,i=0,k=h.length-1;k>=0;--k)b=h[k],b.paused||(c=b._fTime+=a,c>=b._fDur?(0===b._fEnd?(d=this._sounds[b.alias],d.playing=d.playing.splice(d.playing.indexOf(b),1),this._stopInst(b)):(b.curVol=b._fEnd,b.updateVolume()),++i,e=h.length-i,k!=e&&(h[k]=h[e])):(f=c/b._fDur,g=b._fEnd>b._fStart?b._fStart+(b._fEnd-b._fStart)*f:b._fEnd+(b._fStart-b._fEnd)*f,b.curVol=g,b.updateVolume()));h.length=h.length-i,0===h.length&&j.instance.off("update",this._update)},q.play=function(b,c,d,e,f,g,h,i,j){if(this.soundEnabled){var k;c&&u(c)&&(k=c,c=null),k=(c?c.complete:k)||null,d=(c?c.start:d)||null,e=!!(c?c.interrupt:e),f=(c?c.delay:f)||0,g=(c?c.offset:g)||0,h=c?c.loop:h,i=c?c.volume:i,j=(c?c.pan:j)||1e-4,!0===h&&(h=-1);var l=this._sounds[b];if(!l)return void(k&&k());(l.loop&&void 0===h||null===h)&&(h=-1),i="number"==typeof i?i:l.volume;var m,o,p=l.loadState;if(p==s.loaded){this._fixAndroidAudio&&this._lastAudioTime>0&&Date.now()-this._lastAudioTime>=3e4&&a();var q=n.play(b,e,f,g,h,i,j);return q&&q.playState!=n.PLAY_FAILED?(this._fixAndroidAudio&&(this._numPlayingAudio?(this._numPlayingAudio++,this._lastAudioTime=-1):(this._numPlayingAudio=1,this._lastAudioTime=-1)),m=this._getSoundInst(q,l.id),q.handleExtraData&&q.handleExtraData(l.data),m.curVol=i,m._pan=j,l.playing.push(m),m._endCallback=k,m.updateVolume(),m.length=q.getDuration(),l.duration||(l.duration=m.length),m._channel.addEventListener("complete",m._endFunc),d&&setTimeout(d,0),m):(k&&k(),null)}return p==s.unloaded?(l.playAfterLoad=!0,m=this._getSoundInst(null,l.id),m.curVol=i,m._pan=j,l.waitingToPlay.push(m),m._endCallback=k,m._startFunc=d,m._startParams?(o=m._startParams,o[0]=e,o[1]=f,o[2]=g,o[3]=h):m._startParams=[e,f,g,h],this.preloadSound(l.id),m):p==s.loading?(l.playAfterLoad=!0,m=this._getSoundInst(null,l.id),m.curVol=i,m._pan=j,l.waitingToPlay.push(m),m._endCallback=k,m._startFunc=d,m._startParams?(o=m._startParams,o[0]=e,o[1]=f,o[2]=g,o[3]=h):m._startParams=[e,f,g,h],m):void 0}},q._getSoundInst=function(a,b){var c;return this._pool.length?c=this._pool.pop():(c=new h,c._endFunc=this._onSoundComplete.bind(this,c)),c._channel=a,c.alias=b,c.length=a?a.getDuration():0,c.isValid=!0,c},q._playAfterLoad=function(b){var c=t(b)?b:b.id,d=this._sounds[c];if(d.loadState=s.loaded,d.playAfterLoad){this._fixAndroidAudio&&this._lastAudioTime>0&&Date.now()-this._lastAudioTime>=3e4&&a();for(var e,f,g,h,i,j=d.waitingToPlay,k=0,l=j.length;k<l;++k)e=j[k],f=e._startParams,g=e.curVol,i=e._pan,h=n.play(c,f[0],f[1],f[2],f[3],g,i),h&&h.playState!=n.PLAY_FAILED?(this._fixAndroidAudio&&(this._numPlayingAudio?(this._numPlayingAudio++,this._lastAudioTime=-1):(this._numPlayingAudio=1,this._lastAudioTime=-1)),d.playing.push(e),e._channel=h,h.handleExtraData&&h.handleExtraData(d.data),e.length=h.getDuration(),d.duration||(d.duration=e.length),e.updateVolume(),h.addEventListener("complete",e._endFunc),e._startFunc&&e._startFunc(),e.paused&&h.pause()):(e._endCallback&&e._endCallback(),this._poolInst(e));j.length=0}},q._onSoundComplete=function(a){if(a._channel){this._fixAndroidAudio&&0==--this._numPlayingAudio&&(this._lastAudioTime=Date.now()),a._channel.removeEventListener("complete",a._endFunc);var b=this._sounds[a.alias],c=b.playing.indexOf(a);c>-1&&b.playing.splice(c,1);var d=a._endCallback;this._poolInst(a),d&&d()}},q.stop=function(a){var b=this._sounds[a];if(b)if(b.playing.length)this._stopSound(b);else if(b.loadState==s.loading){b.playAfterLoad=!1;for(var c,d=b.waitingToPlay,e=0,f=d.length;e<f;++e)c=d[e],this._poolInst(c);d.length=0}},q._stopSound=function(a){for(var b=a.playing,c=b.length-1;c>=0;--c)this._stopInst(b[c]);b.length=0},q._stopInst=function(a){a._channel&&(!a.paused&&this._fixAndroidAudio&&0==--this._numPlayingAudio&&(this._lastAudioTime=Date.now()),a._channel.removeEventListener("complete",a._endFunc),a._channel.stop()),this._poolInst(a)},q.stopContext=function(a){if(a=this._contexts[a])for(var b,c=a.sounds,d=c.length-1;d>=0;--d)b=c[d],b.playing.length?this._stopSound(b):b.loadState==s.loading&&(b.playAfterLoad=!1)},q.stopAll=function(){for(var a in this._sounds)this.stop(a)},q.pauseSound=function(a){t(a)&&(a=this._sounds[a]);var b,c=a.playing;for(b=c.length-1;b>=0;--b)c[b].pause();for(c=a.waitingToPlay,b=c.length-1;b>=0;--b)c[b].pause()},q.unpauseSound=function(a){t(a)&&(a=this._sounds[a]);var b,c=a.playing;for(b=c.length-1;b>=0;--b)c[b].unpause();for(c=a.waitingToPlay,b=c.length-1;b>=0;--b)c[b].unpause()},q.pauseAll=function(){var a=this._sounds;for(var b in a)this.pauseSound(a[b])},q.unpauseAll=function(){var a=this._sounds;for(var b in a)this.unpauseSound(a[b])},q._onInstancePaused=function(){this._fixAndroidAudio&&0==--this._numPlayingAudio&&(this._lastAudioTime=Date.now())},q._onInstanceResume=function(){this._fixAndroidAudio&&(this._lastAudioTime>0&&Date.now()-this._lastAudioTime>3e4&&a(),this._numPlayingAudio++,this._lastAudioTime=-1)},q.setContextMute=function(a,b){if(a=this._contexts[a]){a.muted=b;for(var c,d,e,f=a.volume,g=a.sounds,h=g.length-1;h>=0;--h)if(c=g[h],c.playing.length)for(d=c.playing,e=d.length-1;e>=0;--e)d[e].updateVolume(b?0:f)}},Object.defineProperty(q,"muteAll",{set:function(a){n.setMute(!!a)}}),q.setContextVolume=function(a,b){if(a=this._contexts[a]){var c=a.muted;a.volume=b;for(var d,e,f,g=a.sounds,h=g.length-1;h>=0;--h)if(d=g[h],d.playing.length)for(e=d.playing,f=e.length-1;f>=0;--f)e[f].updateVolume(c?0:b)}},q.preloadSound=function(a,b){var c=this._sounds[a];c&&c.loadState==s.unloaded&&(c.loadState=s.loading,c.preloadCallback=b||null,d.instance.load(c.src,this._markLoaded,null,0,c))},q.preload=function(a,b){if(!e||!f)throw"The Task Module is needed to preload audio!";if(!a||0===a.length)return void(b&&b());for(var c,d=[],g=0,h=a.length;g<h;++g)(c=this._sounds[a[g]])&&c.loadState==s.unloaded&&(c.loadState=s.loading,d.push(new e(c.id,c.src,this._markLoaded,null,0,c)));d.length>0?f.process(d,function(){b&&b()}):b&&b()},q._markLoaded=function(a){var b=a.id,c=this._sounds[b];c&&(c.loadState=s.loaded,c.playAfterLoad&&this._playAfterLoad(b));var d=c.preloadCallback;d&&(c.preloadCallback=null,d())},q.createPreloadTask=function(a,b,c){return i?new i(a,b,c):null},q.unload=function(a){if(a)for(var b,c=0,d=a.length;c<d;++c)b=this._sounds[a[c]],b&&(this._stopSound(b),b.loadState=s.unloaded),n.removeSound(a[c])},q.unloadAll=function(){var a=[];for(var b in this._sounds)a.push(b);this.unload(a)},q._poolInst=function(a){-1==this._pool.indexOf(a)&&(a._endCallback=null,a.alias=null,a._channel=null,a._startFunc=null,a.curVol=0,a.paused=!1,a.isValid=!1,this._pool.push(a))},q.destroy=function(){if(this.stopAll(),n.removeAllSounds(),m&&n.activePlugin instanceof m){var a=document.getElementById("SoundJSFlashContainer");a&&a.parentNode&&a.parentNode.removeChild(a)}r=null,this._sounds=null,this._volumes=null,this._fades=null,this._contexts=null,this._pool=null};var t=function(a){return"string"==typeof a},u=function(a){return"function"==typeof a};namespace("springroll").Sound=p}(),function(){var a,b,c=include("springroll.Sound"),d=function(){b||(a=include("springroll.Captions",!1),b=include("springroll.Application")),this._onSoundFinished=this._onSoundFinished.bind(this),this._updateSilence=this._updateSilence.bind(this),this._updateSoloCaption=this._updateSoloCaption.bind(this),this._syncCaptionToSound=this._syncCaptionToSound.bind(this),this._listHelper=[],this.trackSound=!1,this.soundList=null,this._listCounter=0,this._currentSound=null,this._soundInstance=null,this._callback=null,this._cancelledCallback=null,this._playedSound=null,this._timer=0,this._captions=null},e=d.prototype={};Object.defineProperty(e,"playing",{get:function(){return null!==this._currentSound||this._timer>0}}),Object.defineProperty(e,"captions",{set:function(a){this._captions=a,a&&(a.selfUpdate=!1)},get:function(){return this._captions}}),e.getElapsed=function(){var a,b,d=0;for(b=0;b<this._listCounter;++b)a=this.soundList[b],"string"==typeof a?d+=c.instance.getDuration(a):"number"==typeof a&&(d+=a);return b=this._listCounter,b<this.soundList.length&&(a=this.soundList[b],"string"==typeof a?d+=this._soundInstance.position:"number"==typeof a&&(d+=a-this._timer)),d},e.play=function(a,b,c){this.stop(),this._listCounter=-1,"string"==typeof a?(this._listHelper[0]=a,this.soundList=this._listHelper):this.soundList=a,this._callback=b,this._cancelledCallback=c,this._onSoundFinished()},e._onSoundFinished=function(){if(b.instance.off("update",[this._updateSoloCaption,this._syncCaptionToSound,this._updateSilence]),this._captions&&this._soundInstance&&this._captions.seek(this._soundInstance.length),this._soundInstance=null,++this._listCounter>=this.soundList.length){this._captions&&this._captions.stop(),this._currentSound=null,this._cancelledCallback=null;var a=this._callback;this._callback=null,a&&a()}else this._currentSound=this.soundList[this._listCounter],"string"==typeof this._currentSound?this._playSound():"function"==typeof this._currentSound?(this._currentSound(),this._onSoundFinished()):(this._timer=this._currentSound,this._currentSound=null,b.instance.on("update",this._updateSilence))},e._updateSilence=function(a){this._timer-=a,this._timer<=0&&this._onSoundFinished()},e._updateSoloCaption=function(a){this._timer+=a,this._captions.seek(this._timer),this._timer>=this._captions.duration&&this._onSoundFinished()},e._syncCaptionToSound=function(a){this._soundInstance&&this._captions.seek(this._soundInstance.position)},e._playSound=function(){this.trackSound&&(this._playedSound?-1==this._playedSound.indexOf(this._currentSound)&&this._playedSound.push(this._currentSound):this._playedSound=[this._currentSound]);var a=c.instance;!a.exists(this._currentSound)&&this._captions&&this._captions.hasCaption(this._currentSound)?(this._captions.play(this._currentSound),this._timer=0,this._currentSound=null,b.instance.on("update",this._updateSoloCaption)):(this._soundInstance=a.play(this._currentSound,this._onSoundFinished),this._captions&&(this._captions.play(this._currentSound),b.instance.on("update",this._syncCaptionToSound)));for(var d,e=this.soundList.length,f=this._listCounter+1;f<e;++f)if("string"==typeof(d=this.soundList[f])){a.isLoaded(d)||a.preloadSound(d);break}},e.stop=function(){this._currentSound&&(c.instance.stop(this._currentSound),this._currentSound=null),this._captions&&this._captions.stop(),b.instance.off("update",[this._updateSoloCaption,this._syncCaptionToSound,this._updateSilence]),this.soundList=null,this._timer=0,this._callback=null;var a=this._cancelledCallback;this._cancelledCallback=null,a&&a()},e.unloadSound=function(){c.instance.unload(this._playedSound),this._playedSound=null},e.destroy=function(){this.stop(),this.soundList=null,this._listHelper=null,this._currentSound=null,this._soundInstance=null,this._callback=null,this._cancelledCallback=null,this._playedSound=null,this._captions=null},namespace("springroll").VOPlayer=d,namespace("springroll").Sound.VOPlayer=d}(),function(){var a=include("springroll.ApplicationPlugin"),b=include("springroll.Sound"),c=include("springroll.VOPlayer"),d=new a(90);d.setup=function(){this.options.add("swfPath","assets/swfs/",!0),this.options.add("forceFlashAudio",!1,!0),this.options.add("audioTypes",["ogg","mp3"],!0),this._music=null,this._musicInstance=null,this.voPlayer=new c,this.sound=null,Object.defineProperty(this,"music",{set:function(a){if(a!=this._music){var b=this.sound;this._music&&(b.fadeOut(this._music),this._musicInstance=null),this._music=a,a&&(this._musicInstance=b.play(this._music,{start:b.fadeIn.bind(b,a),loop:-1}))}},get:function(){return this._music}}),Object.defineProperty(this,"musicInstance",{get:function(){return this._musicInstance}}),this.once("configLoaded",function(a){var b=a.sounds,c=this.sound;b&&(b.vo&&c.addContext(b.vo),b.sfx&&c.addContext(b.sfx),b.music&&c.addContext(b.music))})},d.preload=function(a){b.init({swfPath:this.options.swfPath,types:this.options.audioTypes,ready:function(){if(!this.destroyed){var c=this.sound=b.instance;this.on({paused:function(){c.pauseAll()},resumed:function(){c.unpauseAll()}}),this.trigger("soundReady"),a()}}.bind(this)})},d.teardown=function(){this.voPlayer&&(this.voPlayer.destroy(),this.voPlayer=null),this.sound&&(this.sound.destroy(),this.sound=null)}}();}();